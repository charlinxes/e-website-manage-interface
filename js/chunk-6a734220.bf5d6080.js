(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6a734220"],{"9aa6":function(t,e,a){
/*!
  * Bootstrap alert.js v5.1.0 (https://getbootstrap.com/)
  * Copyright 2011-2021 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */
(function(e,s){t.exports=s(a("6a95"),a("302d"))})(0,(function(t,e){"use strict";function a(t){return t&&"object"===typeof t&&"default"in t?t:{default:t}}var s=a(t),o=a(e);const n=t=>{let e=t.getAttribute("data-bs-target");if(!e||"#"===e){let a=t.getAttribute("href");if(!a||!a.includes("#")&&!a.startsWith("."))return null;a.includes("#")&&!a.startsWith("#")&&(a="#"+a.split("#")[1]),e=a&&"#"!==a?a.trim():null}return e},i=t=>{const e=n(t);return e?document.querySelector(e):null},l=t=>!t||t.nodeType!==Node.ELEMENT_NODE||(!!t.classList.contains("disabled")||("undefined"!==typeof t.disabled?t.disabled:t.hasAttribute("disabled")&&"false"!==t.getAttribute("disabled"))),d=()=>{const{jQuery:t}=window;return t&&!document.body.hasAttribute("data-bs-no-jquery")?t:null},r=[],c=t=>{"loading"===document.readyState?(r.length||document.addEventListener("DOMContentLoaded",()=>{r.forEach(t=>t())}),r.push(t)):t()},u=t=>{c(()=>{const e=d();if(e){const a=t.NAME,s=e.fn[a];e.fn[a]=t.jQueryInterface,e.fn[a].Constructor=t,e.fn[a].noConflict=()=>(e.fn[a]=s,t.jQueryInterface)}})},p=(t,e="hide")=>{const a="click.dismiss"+t.EVENT_KEY,o=t.NAME;s["default"].on(document,a,`[data-bs-dismiss="${o}"]`,(function(a){if(["A","AREA"].includes(this.tagName)&&a.preventDefault(),l(this))return;const s=i(this)||this.closest("."+o),n=t.getOrCreateInstance(s);n[e]()}))},m="alert",h="bs.alert",f="."+h,v="close"+f,b="closed"+f,_="fade",C="show";class g extends o["default"]{static get NAME(){return m}close(){const t=s["default"].trigger(this._element,v);if(t.defaultPrevented)return;this._element.classList.remove(C);const e=this._element.classList.contains(_);this._queueCallback(()=>this._destroyElement(),this._element,e)}_destroyElement(){this._element.remove(),s["default"].trigger(this._element,b),this.dispose()}static jQueryInterface(t){return this.each((function(){const e=g.getOrCreateInstance(this);if("string"===typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t](this)}}))}}return p(g,"close"),u(g),g}))},f329:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"coupons"},[a("Loading",{attrs:{active:t.isOuterLoading,loader:"bars"},on:{"update:active":function(e){t.isOuterLoading=e}}}),t.showAlert?a("div",{staticClass:"alert alert-danger alert-dismissible fade show\n    w-auto d-inline-block position-absolute start-50 translate-middle-x",attrs:{id:"myAlert",role:"alert"}},[a("strong",[t._v(t._s(t.alertMessage))]),a("button",{staticClass:"btn-close",attrs:{type:"button","data-bs-dismiss":"alert","aria-label":"Close"}})]):t._e(),a("div",{staticClass:"text-end mt-4"},[a("button",{staticClass:"btn btn-primary",on:{click:function(e){return e.preventDefault(),t.showModal(!0)}}},[t._v("建立新的優惠卷")])]),a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table mt-4 text-nowrap"},[t._m(0),a("tbody",t._l(t.coupons,(function(e){return a("tr",{key:e.id,staticClass:"text-center"},[a("td",[t._v(t._s(e.title))]),a("td",[t._v(t._s(e.percent)+"%")]),a("td",[t._v(t._s(t._f("dateFilter")(e.due_date)))]),a("td",[1==e.is_enabled?a("span",{staticClass:"text-success"},[t._v("啟用")]):a("span",[t._v("未啟用")])]),a("td",[a("button",{staticClass:"btn btn-outline-primary btn-sm",on:{click:function(a){return a.preventDefault(),t.showModal(!1,e)}}},[t._v("編輯")]),a("button",{staticClass:"btn btn-outline-danger btn-sm ms-2",on:{click:function(a){return a.preventDefault(),t.showDelModal(e)}}},[t._v("刪除")])])])})),0)])]),a("div",{staticClass:"modal fade",attrs:{id:"couponModal",tabindex:"-1",role:"dialog","aria-labelledby":"couponModalLabel","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[a("ValidationObserver",{ref:"form",scopedSlots:t._u([{key:"default",fn:function(e){var s=e.handleSubmit;return[a("form",{attrs:{novalidate:""},on:{submit:function(e){return e.preventDefault(),s(t.updateCoupon)}}},[a("div",{staticClass:"modal-content border-0"},[a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title",attrs:{id:"couponModalLabel"}},[t._v(" 優惠卷 ")]),a("button",{staticClass:"btn-close",attrs:{type:"button","aria-label":"Close"},on:{click:function(e){return e.preventDefault(),t.hideModal.apply(null,arguments)}}})]),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[a("ValidationProvider",{attrs:{name:"title",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.errors,o=e.classes;return[a("label",{attrs:{for:"title"}},[t._v("標題")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempCoupon.title,expression:"tempCoupon.title"}],staticClass:"form-control",class:o,attrs:{type:"text",id:"title",placeholder:"請輸入標題"},domProps:{value:t.tempCoupon.title},on:{input:function(e){e.target.composing||t.$set(t.tempCoupon,"title",e.target.value)}}}),a("p",{staticClass:"text-danger fw-bold mt-1 mb-1"},[t._v(t._s(s[0]))])]}}],null,!0)})],1),a("div",{staticClass:"col-12 mt-3"},[a("ValidationProvider",{attrs:{name:"coupon_code",rules:{regex:/^[a-zA-Z0-9]+$/,length:10}},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.errors,o=e.classes;return[a("label",{attrs:{for:"coupon_code"}},[t._v("優惠碼")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempCoupon.code,expression:"tempCoupon.code"}],staticClass:"form-control",class:o,attrs:{type:"text",id:"coupon_code",placeholder:"請輸入優惠碼",required:""},domProps:{value:t.tempCoupon.code},on:{input:function(e){e.target.composing||t.$set(t.tempCoupon,"code",e.target.value)}}}),a("p",{staticClass:"text-danger fw-bold mt-1 mb-1"},[t._v(t._s(s[0]))])]}}],null,!0)})],1),a("div",{staticClass:"col-12 mt-3"},[a("ValidationProvider",{attrs:{name:"due_date",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.errors,o=e.classes;return[a("label",{attrs:{for:"due_date"}},[t._v("到期日")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.due_date,expression:"due_date"}],staticClass:"form-control",class:o,attrs:{type:"date",id:"due_date"},domProps:{value:t.due_date},on:{input:function(e){e.target.composing||(t.due_date=e.target.value)}}}),a("p",{staticClass:"text-danger fw-bold mt-1 mb-1"},[t._v(t._s(s[0]))])]}}],null,!0)})],1),a("div",{staticClass:"col-12 mt-3"},[a("ValidationProvider",{attrs:{name:"discount",rules:"required|min_value:0"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.errors,o=e.classes;return[a("label",{attrs:{for:"discount"}},[t._v("折扣百分比")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempCoupon.percent,expression:"tempCoupon.percent"}],staticClass:"form-control",class:o,attrs:{type:"text",id:"discount",placeholder:"請輸入折扣百分比"},domProps:{value:t.tempCoupon.percent},on:{input:function(e){e.target.composing||t.$set(t.tempCoupon,"percent",e.target.value)}}}),a("p",{staticClass:"text-danger fw-bold mt-1 mb-1"},[t._v(t._s(s[0]))])]}}],null,!0)})],1),a("div",{staticClass:"col-12 mt-3"},[a("div",{staticClass:"form-check"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempCoupon.is_enabled,expression:"tempCoupon.is_enabled"}],staticClass:"form-check-input",attrs:{type:"checkbox",id:"is_enabled","true-value":"1","false-value":"0"},domProps:{checked:Array.isArray(t.tempCoupon.is_enabled)?t._i(t.tempCoupon.is_enabled,null)>-1:t._q(t.tempCoupon.is_enabled,"1")},on:{change:function(e){var a=t.tempCoupon.is_enabled,s=e.target,o=s.checked?"1":"0";if(Array.isArray(a)){var n=null,i=t._i(a,n);s.checked?i<0&&t.$set(t.tempCoupon,"is_enabled",a.concat([n])):i>-1&&t.$set(t.tempCoupon,"is_enabled",a.slice(0,i).concat(a.slice(i+1)))}else t.$set(t.tempCoupon,"is_enabled",o)}}}),a("label",{staticClass:"form-check-label",attrs:{for:"is_enabled"}},[t._v("是否啟用")])])])])]),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-outline-secondary",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.hideModal.apply(null,arguments)}}},[t._v("關閉")]),a("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v("確認優惠卷內容")])])])])]}}])})],1)]),a("div",{staticClass:"modal fade",attrs:{id:"delCouponModal",tabindex:"-1",role:"dialog","aria-labelledby":"couponModalLabel","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[a("div",{staticClass:"modal-content border-0"},[t._m(1),a("div",{staticClass:"modal-body"},[t._v(" 是否刪除 "),a("strong",{staticClass:"text-danger"},[t._v(t._s(t.tempCoupon.title))]),t._v(" 優惠卷(刪除後將無法恢復)。 ")]),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-outline-secondary",attrs:{type:"button","data-bs-dismiss":"modal"}},[t._v("取消")]),a("button",{staticClass:"btn btn-danger",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.updateCoupon.apply(null,arguments)}}},[t._v("確認刪除")])])])])]),a("Pagination",t._b({on:{updateDataList:t.getCoupons}},"Pagination",t.paginationObj,!1))],1)},o=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",{staticClass:"text-center"},[a("th",[t._v("名稱")]),a("th",{attrs:{width:"16%"}},[t._v("折扣百分比")]),a("th",{attrs:{width:"18%"}},[t._v("到期日")]),a("th",{staticClass:"text-center",attrs:{width:"15%"}},[t._v("是否啟用")]),a("th",{staticClass:"text-center",attrs:{width:"20%"}},[t._v("編輯 / 刪除")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-header bg-danger text-white"},[a("h5",{staticClass:"modal-title",attrs:{id:"couponModalLabel"}},[a("span",[t._v("刪除優惠卷")])]),a("button",{staticClass:"btn-close",attrs:{type:"button","aria-label":"Close","data-bs-dismiss":"modal"}})])}],n=a("5530"),i=(a("99af"),a("7c2b")),l=a.n(i),d=a("9aa6"),r=a.n(d),c=a("7bb1"),u=a("1799"),p=a("442a"),m={name:"Coupons",data:function(){return{coupons:[],tempCoupon:{title:"",is_enabled:0,percent:100,due_date:"",code:""},myModal:{},modalState:"",isOuterLoading:!1,showAlert:!1,alertMessage:"",due_date:"",paginationObj:{total_pages:1,current_page:1,has_pre:!1,has_next:!1}}},components:{Pagination:u["a"],ValidationProvider:c["b"],ValidationObserver:c["a"]},created:function(){this.getCoupons()},mounted:function(){this.myModal=new l.a(document.getElementById("couponModal")),this.delMyModal=new l.a(document.getElementById("delCouponModal")),this.myAlert=new r.a(document.getElementById("myAlert"))},watch:{due_date:function(){var t=Math.floor(new Date(this.due_date)/1e3);this.tempCoupon.due_date=t}},methods:{getCoupons:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.isOuterLoading=!0;var a="".concat("https://vue-course-api.hexschool.io","/api/").concat("charlie","/admin/coupons?page=").concat(e);this.$http.get(a).then((function(e){t.isOuterLoading=!1,t.coupons=e.data.coupons,t.paginationObj=e.data.pagination}))},showModal:function(t,e){t?(this.tempCoupon={},this.due_date="",this.modalState="add",this.myModal.show()):(this.tempCoupon=Object(n["a"])({},e),this.due_date=Object(p["a"])(e.due_date),this.modalState="revise",this.myModal.show())},showDelModal:function(t){this.tempCoupon=Object(n["a"])({},t),this.modalState="delete",this.delMyModal.show()},hideModal:function(){this.myModal.hide(),this.$refs.form.reset()},updateCoupon:function(){var t=this;if("add"===this.modalState){var e="".concat("https://vue-course-api.hexschool.io","/api/").concat("charlie","/admin/coupon");this.$http.post(e,{data:this.tempCoupon}).then((function(e){e.data.success?(t.hideModal(),t.getCoupons()):(t.hideModal(),t.alertShow(e.data.message))}))}else if("revise"===this.modalState){var a="".concat("https://vue-course-api.hexschool.io","/api/").concat("charlie","/admin/coupon/").concat(this.tempCoupon.id);this.$http.put(a,{data:this.tempCoupon}).then((function(e){e.data.success?(t.hideModal(),t.getCoupons()):(t.hideModal(),t.alertShow(e.data.message))}))}else if("delete"===this.modalState){var s="".concat("https://vue-course-api.hexschool.io","/api/").concat("charlie","/admin/coupon/").concat(this.tempCoupon.id);this.$http.delete(s,{data:this.tempCoupon}).then((function(e){e.data.success?(t.delMyModal.hide(),t.getCoupons()):(t.delMyModal.hide(),t.alertShow(e.data.message))}))}},alertShow:function(t){var e=this;this.alertMessage=t,this.showAlert=!0,setTimeout((function(){e.showAlert=!1}),5e3)}}},h=m,f=a("2877"),v=Object(f["a"])(h,s,o,!1,null,null,null);e["default"]=v.exports}}]);
//# sourceMappingURL=chunk-6a734220.bf5d6080.js.map